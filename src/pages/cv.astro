---
import Layout from '../layouts/Layout.astro';

// Replace with your GitHub username and repository name
const GITHUB_USERNAME = 'nicovsj';
const REPO_NAME = 'cv'; // your CV repository name
---

<Layout title="CV | Academic Profile">
  <h1>Curriculum Vitae</h1>

  <section class="cv-section">
    <p>You can download my latest CV in PDF format:</p>
    <div class="cv-download">
      <a
        href={`https://github.com/${GITHUB_USERNAME}/${REPO_NAME}/releases/latest/download/cv.pdf`}
        class="download-button"
        target="_blank"
        rel="noopener noreferrer"
      >
        Download CV (PDF)
      </a>
      <p class="last-updated">
        Last updated: <span id="last-updated">Loading...</span>
      </p>
    </div>
  </section>
</Layout>

<style>
  .cv-section {
    margin: 2rem 0;
  }

  .cv-download {
    margin: 2rem 0;
    text-align: center;
  }

  .download-button {
    display: inline-block;
    padding: 1rem 2rem;
    background-color: rgb(var(--accent));
    color: white;
    text-decoration: none;
    border-radius: 4px;
    font-weight: 500;
    transition: background-color 0.2s;
  }

  .download-button:hover {
    background-color: rgb(var(--accent-dark));
    text-decoration: none;
  }

  .last-updated {
    margin-top: 1rem;
    color: #666;
    font-size: 0.9rem;
  }
</style>

<script define:vars={{ GITHUB_USERNAME, REPO_NAME }}>
  // Fetch the last release date
  async function updateLastUpdated() {
    try {
      const response = await fetch(
        `https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/releases/latest`
      );
      const data = await response.json();
      const date = new Date(data.published_at);
      const element = document.getElementById('last-updated');
      if (element) {
        element.textContent = date.toLocaleDateString();
      }
    } catch (error) {
      const element = document.getElementById('last-updated');
      if (element) {
        element.textContent = 'Unknown';
      }
    }
  }

  updateLastUpdated();
</script>
